<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ROI del Modelo de Aprendizaje T.E.A.M.</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f9fb;
            color: #1f2937;
        }
        .card {
            background-color: #ffffff;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .input-group input, .input-group select {
            border: 2px solid #e5e7eb;
            transition: border-color 0.3s, box-shadow 0.3s;
        }
        .input-group input:focus, .input-group select:focus {
            border-color: #059669; /* Verde para educación/éxito */
            box-shadow: 0 0 0 3px rgba(5, 150, 105, 0.5);
            outline: none;
        }
        .result-box {
            background-color: #f0fdf4;
            border: 2px solid #a7f3d0;
        }
        .result-label {
            color: #059669;
        }
        .result-value {
            color: #065f46;
        }
        .btn-calculate {
            background-color: #10b981;
            transition: background-color 0.3s, transform 0.1s;
        }
        .btn-calculate:hover {
            background-color: #059669;
        }
        .btn-calculate:active {
            transform: scale(0.98);
        }
        .read-only-field {
            background-color: #eef2ff;
            border: 1px solid #c7d2fe;
            color: #4338ca;
            font-weight: 600;
        }
    </style>
</head>
<body class="p-4 sm:p-8 flex justify-center items-center min-h-screen">

    <div id="calculator-app" class="card w-full max-w-4xl p-6 sm:p-10 rounded-xl">
        <h1 class="text-3xl sm:text-4xl font-extrabold mb-2 text-center text-gray-800">
            Calculadora de ROI del Modelo T.E.A.M.
        </h1>
        <p class="text-center text-gray-500 mb-8">
            Mida la rentabilidad de su inversión en la Metodología Educativa T.E.A.M. (centrado en la Retención de Estudiantes).
        </p>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <!-- Columna de Inputs -->
            <div>
                <h2 class="text-xl font-bold mb-4 text-green-600 border-b pb-2">Datos de Inversión y Eficacia</h2>

                <!-- 1. Costo de Licencia/Adquisición del Modelo T.E.A.M. -->
                <div class="input-group mb-4">
                    <label for="licence_cost" class="block text-sm font-medium mb-1">1. Costo de Licencia Académica Anual (€)</label>
                    <input type="number" id="licence_cost" value="10000" min="0" class="w-full p-3 rounded-lg text-gray-700" placeholder="Ej: 10000" oninput="calculateROI()">
                    <p class="text-xs text-gray-400 mt-1">Costo total de la adopción del Framework T.E.A.M. por un año.</p>
                </div>
                
                <!-- 2. Formación Docente -->
                <div class="input-group mb-4">
                    <label class="block text-sm font-medium mb-1">2. Formación Inicial Docente</label>
                    <div class="w-full p-3 rounded-lg read-only-field">Incluida en el costo de la licencia (€0)</div>
                    <p class="text-xs text-gray-400 mt-1">La licencia académica anual no es exclusiva y cubre el costo de la formación inicial del equipo docente seleccionado.</p>
                </div>

                <!-- 3. Total de Alumnos Matriculados Anuales -->
                <div class="input-group mb-4">
                    <label for="enrolled_students" class="block text-sm font-medium mb-1">3. Total de Alumnos Matriculados Anuales</label>
                    <input type="number" id="enrolled_students" value="1000" min="1" class="w-full p-3 rounded-lg text-gray-700" placeholder="Ej: 1000" oninput="calculateROI()">
                    <p class="text-xs text-gray-400 mt-1">La población estudiantil que usará el modelo T.E.A.M. en el ciclo.</p>
                </div>

                <!-- 4. Tasa de Retención/Finalización Base (Pre-T.E.A.M.) -->
                <div class="input-group mb-4">
                    <label for="retention_base" class="block text-sm font-medium mb-1">4. Tasa de Retención/Finalización Base (Pre-T.E.A.M.) (%)</label>
                    <input type="number" id="retention_base" value="80" min="0" max="100" step="0.1" class="w-full p-3 rounded-lg text-gray-700" placeholder="Ej: 80.0" oninput="calculateROI()">
                    <p class="text-xs text-gray-400 mt-1">Porcentaje actual de alumnos que completan o continúan matriculados sin T.E.A.M.</p>
                </div>

                <!-- 5. Aumento Esperado en Tasa de Retención por T.E.A.M. -->
                <div class="input-group mb-4">
                    <label for="retention_increase" class="block text-sm font-medium mb-1">5. Aumento Esperado en Tasa de Retención por T.E.A.M. (Puntos %)</label>
                    <input type="number" id="retention_increase" value="0.2" min="0" max="100" step="0.1" class="w-full p-3 rounded-lg text-gray-700" placeholder="Ej: 5.0" oninput="calculateROI()">
                    <p class="text-xs text-gray-400 mt-1">Puntos porcentuales de mejora esperada en la tasa de retención (Ej: si pasa de 80% a 80.2%, ingrese 0.2).</p>
                </div>

                <!-- 6. Valor Económico de un Estudiante Retenido (LTV) -->
                <div class="input-group mb-4">
                    <label for="ltv" class="block text-sm font-medium mb-1">6. Valor Económico de un Estudiante Retenido (LTV) (€)</label>
                    <input type="number" id="ltv" value="5000" min="0" class="w-full p-3 rounded-lg text-gray-700" placeholder="Ej: 5000" oninput="calculateROI()">
                    <p class="text-xs text-gray-400 mt-1">Ingreso promedio que genera un estudiante retenido o el costo de la deserción evitada.</p>
                </div>

                <button onclick="calculateROI()" class="btn-calculate w-full p-3 rounded-lg text-white font-semibold mt-4">
                    Calcular ROI
                </button>
            </div>

            <!-- Columna de Resultados -->
            <div class="space-y-6">
                <h2 class="text-xl font-bold mb-4 text-green-600 border-b pb-2">Resultados Proyectados (Primer Ciclo)</h2>

                <!-- Inversión Total -->
                <div class="result-box p-4 rounded-lg">
                    <p class="text-sm result-label">A. Inversión Única Total en Modelo T.E.A.M.</p>
                    <p id="total_investment" class="text-2xl font-bold result-value">€0.00</p>
                </div>

                <!-- Tasa de Retención Proyectada -->
                <div class="result-box p-4 rounded-lg">
                    <p class="text-sm result-label">B. Tasa de Retención Proyectada (Post-T.E.A.M.)</p>
                    <p id="projected_retention_rate" class="text-2xl font-bold result-value">0.00%</p>
                </div>

                <!-- Alumnos Adicionales Retenidos -->
                <div class="result-box p-4 rounded-lg">
                    <p class="text-sm result-label">C. Alumnos Adicionales Retenidos/Finalizados (Anual)</p>
                    <p id="additional_retained_students" class="text-2xl font-bold result-value">0</p>
                </div>

                <!-- Retorno Bruto Adicional -->
                <div class="result-box p-4 rounded-lg">
                    <p class="text-sm result-label">D. Ingreso Bruto Adicional (por Retención)</p>
                    <p id="additional_revenue" class="text-2xl font-bold result-value text-green-700">€0.00</p>
                </div>

                <!-- ROI Final -->
                <div class="result-box p-6 rounded-lg bg-green-100 border-green-400">
                    <p class="text-lg font-semibold result-label">E. Retorno de la Inversión (ROI)</p>
                    <p id="roi_result" class="text-4xl font-extrabold text-green-700">0%</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Función para formatear un número a formato de moneda (Euro: €)
        const formatCurrency = (amount) => {
            return new Intl.NumberFormat('es-ES', { style: 'currency', currency: 'EUR', minimumFractionDigits: 2 }).format(amount);
        };

        // Función principal para el cálculo del ROI
        function calculateROI() {
            // 1. Obtener valores de entrada
            const licenceCost = parseFloat(document.getElementById('licence_cost').value) || 0;
            const enrolledStudents = parseInt(document.getElementById('enrolled_students').value) || 0;
            const retentionBase = parseFloat(document.getElementById('retention_base').value) || 0;
            const retentionIncrease = parseFloat(document.getElementById('retention_increase').value) || 0;
            const ltv = parseFloat(document.getElementById('ltv').value) || 0;

            // 2. Cálculos Intermedios

            // A. Inversión Total Anual (Solo el costo fijo de la licencia, que incluye la formación inicial)
            const totalInvestment = licenceCost;

            // B. Tasa de Retención Proyectada
            const projectedRetentionRate = retentionBase + retentionIncrease; // en %

            // C. Estudiantes Retenidos Base (Sin T.E.A.M.)
            const retainedBase = enrolledStudents * (retentionBase / 100);

            // D. Estudiantes Retenidos Proyectados (Con T.E.A.M.)
            const retainedProjected = enrolledStudents * (projectedRetentionRate / 100);

            // E. Alumnos Adicionales Retenidos/Finalizados
            // Se usa Math.max para asegurar que el valor no sea negativo.
            const additionalRetainedStudents = Math.max(0, retainedProjected - retainedBase);

            // F. Ingreso Bruto Adicional (Retorno)
            // Es el valor económico de los estudiantes retenidos adicionalmente
            const additionalRevenue = additionalRetainedStudents * ltv;

            // G. Ganancia Neta Adicional (Retorno - Inversión)
            const netGain = additionalRevenue - totalInvestment;

            // H. Retorno de la Inversión (ROI)
            let roi = 0;
            if (totalInvestment > 0) {
                // Fórmula ROI: (Ganancia Neta / Inversión Total) * 100
                roi = (netGain / totalInvestment) * 100;
            }

            // 3. Mostrar Resultados

            // A. Inversión Total
            document.getElementById('total_investment').textContent = formatCurrency(totalInvestment);

            // B. Tasa de Retención Proyectada (Aseguramos que no pase de 100%)
            document.getElementById('projected_retention_rate').textContent = Math.min(100, projectedRetentionRate).toFixed(2) + '%';

            // C. Alumnos Adicionales (redondeado al entero más cercano)
            document.getElementById('additional_retained_students').textContent = Math.round(additionalRetainedStudents);

            // D. Ingreso Bruto Adicional (Retorno)
            document.getElementById('additional_revenue').textContent = formatCurrency(additionalRevenue);

            // E. ROI Final
            document.getElementById('roi_result').textContent = roi.toFixed(1) + '%';
            // Cambiar color si es negativo
            document.getElementById('roi_result').classList.toggle('text-red-600', roi < 0);
            document.getElementById('roi_result').classList.toggle('text-green-700', roi >= 0);
        }

        // Ejecutar el cálculo inicial al cargar la página
        window.onload = calculateROI;
    </script>
</body>
</html>
